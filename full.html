<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>سامانه مدیریت گلخانه</title>
  <link href="https://fonts.googleapis.com/css2?family=Vazir&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Vazir', sans-serif;
      background-color: #f5f5f5; 
      color: #333;
      text-align: center;
      padding: 4rem;
    }

    .hero {
      max-width: 600px;
      margin: auto;
      background: white;
      padding: 3rem;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
    }

    p {
      font-size: 1.1rem;
      margin-bottom: 2rem;
    }

    .btn {
      display: inline-block;
      padding: 1rem 2rem;
      background-color: #4caf50;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      transition: background-color 0.3s;
    }

    .btn:hover {
      background-color: #388e3c;
    }
  </style>
</head>
<body>

<div class="hero">
  <h1>به سامانه مدیریت گلخانه خوش آمدید</h1>
  <p>این یک دموی تعاملی از پلتفرم مدیریت گلخانه است که شامل ثبت داده، داشبورد، تحلیل تخصصی و بیشتر است.</p>
  <a href="login.html" class="btn">شروع استفاده</a>
</div>

</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ورود به پنل</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="login-page">
<div class="login-box">
  <h3>ورود به پنل کاربری</h3>
  <input type="text" id="username" placeholder="نام کاربری">
  <input type="password" id="password" placeholder="رمز عبور">
  <button onclick="login()">ورود</button>
  <p id="error-message"></p>
  <p>حساب ندارید؟ <a href="register.html">ثبت‌نام کنید</a></p>
</div>

<script src="app.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ثبت‌نام</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="login-page">
<div class="login-box">
  <h3>ثبت‌نام در سامانه</h3>
  <input type="text" id="username" placeholder="نام کاربری">
  <input type="password" id="password" placeholder="رمز عبور">
  <select id="role">
    <option value="grower">گلخانه‌دار</option>
    <option value="expert">کارشناس</option>
    <option value="admin">مدیر</option>
  </select>
  <button onclick="register()">ثبت‌نام</button>
  <p id="error-message"></p>
  <p>حساب دارید؟ <a href="login.html">وارد شوید</a></p>
</div>

<script src="app.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>پلتفرم مدیریت گلخانه</title>
  <!-- Materialize CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"  rel="stylesheet">
  <!-- Vazir Font -->
  <link href="https://fonts.googleapis.com/css2?family=Vazir&display=swap" rel="stylesheet">
  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="styles.css" rel="stylesheet">
</head>
<body>

<!-- Navbar -->
<div class="navbar-fixed">
  <nav>
    <div class="nav-wrapper">
      <a href="#" class="brand-logo right">مدیریت گلخانه</a> 
      <ul class="left">
        <li><a href="#form-section">ثبت داده</a></li>
        <li><a href="#dashboard-section">داشبورد</a></li>
        <li><a href="#expert-section">تحلیل تخصصی</a></li>
        <li><a href="#" id="dark-mode-toggle"><i class="fas fa-moon"></i></a></li>
      </ul>
    </div>
  </nav>
</div>

<!-- Critical Alert Banner -->
<div id="critical-alert" class="alert hidden">هشدار: شرایط بحرانی شناسایی شد!</div>

<!-- Form Section -->
<section id="form-section" class="container section scrollspy">
  <div class="card collapsible">
    <div class="card-content">
      <h4>ثبت داده‌های گلخانه</h4>
      <form id="greenhouse-form">
        <div class="input-field">
          <input id="soil-ph" type="number" step="0.1" min="0" max="14" required>
          <label for="soil-ph">pH خاک</label>
        </div>
        <div class="input-field">
          <input id="temperature" type="number" step="0.1" min="-10" max="50" required>
          <label for="temperature">دما (°C)</label>
        </div>
        <div class="input-field">
          <input id="humidity" type="number" step="1" min="0" max="100" required>
          <label for="humidity">رطوبت (%)</label>
        </div>
        <div class="input-field">
          <select id="irrigation-status" required>
            <option value="" disabled selected>وضعیت آبیاری</option>
            <option value="کم">کم</option>
            <option value="متوسط">متوسط</option>
            <option value="زیاد">زیاد</option>
          </select>
          <label>وضعیت آبیاری</label>
        </div>
        <div class="input-field">
          <select id="crop-type" required>
            <option value="" disabled selected>نوع محصول</option>
            <option value="گوجه‌فرنگی">گوجه‌فرنگی</option>
            <option value="خیار">خیار</option>
            <option value="فلفل">فلفل</option>
            <option value="کاهو">کاهو</option>
          </select>
          <label>نوع محصول</label>
        </div>
        <div class="input-field">
          <input id="timestamp" type="text" class="datepicker" required>
          <label for="timestamp">تاریخ و زمان</label>
        </div>
        <button type="submit" class="btn"><i class="fas fa-save left"></i>ثبت</button>
        <button type="button" class="btn grey" id="reset-form"><i class="fas fa-undo left"></i>بازنشانی</button>
      </form>
      <div id="success-message" class="success-message">داده با موفقیت ثبت شد!</div>
    </div>
  </div>
</section>

<!-- Dashboard Section -->
<section id="dashboard-section" class="container section scrollspy">
  <div class="card collapsible">
    <div class="card-content">
      <h4>داشبورد</h4>
      <div class="row">
        <div class="col s12 m6">
          <div class="input-field">
            <select id="crop-filter">
              <option value="همه">همه</option>
              <option value="گوجه‌فرنگی">گوجه‌فرنگی</option>
              <option value="خیار">خیار</option>
              <option value="فلفل">فلفل</option>
              <option value="کاهو">کاهو</option>
            </select>
            <label>فیلتر بر اساس محصول</label>
          </div>
        </div>
        <div class="col s12 m6">
          <button class="btn" id="export-csv"><i class="fas fa-download left"></i>دانلود CSV</button>
        </div>
      </div>
      <div class="card summary-card">
        <div class="card-content">
          <h5>خلاصه داده‌ها</h5>
          <p id="summary-text"></p>
        </div>
      </div>
      <table class="highlight">
        <thead>
        <tr>
          <th>pH خاک</th>
          <th>دما (°C)</th>
          <th>رطوبت (%)</th>
          <th>وضعیت آبیاری</th>
          <th>نوع محصول</th>
          <th>زمان</th>
        </tr>
        </thead>
        <tbody id="data-table"></tbody>
      </table>
      <div class="row">
        <div class="col s12 m4">
          <canvas id="ph-chart"></canvas>
        </div>
        <div class="col s12 m4">
          <canvas id="temp-chart"></canvas>
        </div>
        <div class="col s12 m4">
          <canvas id="humidity-chart"></canvas>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Expert View Section -->
<section id="expert-section" class="container section scrollspy">
  <div class="card collapsible">
    <div class="card-content">
      <h4>تحلیل تخصصی</h4>
      <div class="input-field">
        <select id="recommendation-filter">
          <option value="همه">همه</option>
          <option value="گوجه‌فرنگی">گوجه‌فرنگی</option>
          <option value="خیار">خیار</option>
          <option value="فلفل">فلفل</option>
          <option value="کاهو">کاهو</option>
        </select>
        <label>فیلتر توصیه‌ها بر اساس محصول</label>
      </div>
      <table class="highlight">
        <thead>
        <tr>
          <th>pH خاک</th>
          <th>دما (°C)</th>
          <th>رطوبت (%)</th>
          <th>وضعیت آبیاری</th>
          <th>نوع محصول</th>
          <th>امتیاز شدت</th>
          <th>وضعیت</th>
          <th>توصیه‌ها</th>
        </tr>
        </thead>
        <tbody id="expert-table"></tbody>
      </table>
      <h5>ثبت توصیه دستی</h5>
      <form id="recommendation-form">
        <div class="input-field">
          <textarea id="recommendation-text" class="materialize-textarea" required></textarea>
          <label for="recommendation-text">توصیه</label>
        </div>
        <button type="submit" class="btn"><i class="fas fa-save left"></i>ثبت توصیه</button>
      </form>
      <h5>توصیه‌های دستی</h5>
      <ul id="manual-recommendations" class="collection"></ul>
    </div>
  </div>
</section>

<!-- Loading Spinner -->
<div id="loading-spinner" class="spinner hidden">
  <div class="preloader-wrapper active">
    <div class="spinner-layer spinner-green-only">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div>
      <div class="gap-patch">
        <div class="circle"></div>
      </div>
      <div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
  </div>
</div>

<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script> 
<script src="app.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>پنل گلخانه‌دار</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"  rel="stylesheet">
</head>
<body>
<nav>
  <div class="nav-wrapper green darken-2">
    <a href="#" class="brand-logo right">ثبت داده</a>
    <ul class="left">
      <li><a href="dashboard.html">داشبورد</a></li>
      <li><a href="#" onclick="logout()">خروج</a></li>
    </ul>
  </div>
</nav>

<section class="container section scrollspy">
  <h4>ثبت داده گلخانه</h4>
  <form id="greenhouse-form">
    <div class="input-field">
      <input id="soil-ph" type="number" step="0.1" min="0" max="14" required>
      <label for="soil-ph">pH خاک</label>
    </div>
    <div class="input-field">
      <input id="temperature" type="number" step="0.1" min="-10" max="50" required>
      <label for="temperature">دما (°C)</label>
    </div>
    <div class="input-field">
      <input id="humidity" type="number" step="1" min="0" max="100" required>
      <label for="humidity">رطوبت (%)</label>
    </div>
    <div class="input-field">
      <select id="irrigation-status" required>
        <option value="" disabled selected>وضعیت آبیاری</option>
        <option value="کم">کم</option>
        <option value="متوسط">متوسط</option>
        <option value="زیاد">زیاد</option>
      </select>
      <label>وضعیت آبیاری</label>
    </div>
    <div class="input-field">
      <select id="crop-type" required>
        <option value="" disabled selected>نوع محصول</option>
        <option value="گوجه‌فرنگی">گوجه‌فرنگی</option>
        <option value="خیار">خیار</option>
        <option value="فلفل">فلفل</option>
        <option value="کاهو">کاهو</option>
      </select>
      <label>نوع محصول</label>
    </div>
    <button type="submit" class="btn green"><i class="fas fa-save left"></i>ثبت داده</button>
  </form>

  <h5>داده‌های من</h5>
  <table class="highlight">
    <thead>
    <tr>
      <th>pH خاک</th>
      <th>دما</th>
      <th>رطوبت</th>
      <th>محصول</th>
    </tr>
    </thead>
    <tbody id="data-table"></tbody>
  </table>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> 
<script src="app.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>پنل کارشناس</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"  rel="stylesheet">
</head>
<body>
<nav>
  <div class="nav-wrapper amber darken-2">
    <a href="#" class="brand-logo right">تحلیل تخصصی</a>
    <ul class="left">
      <li><a href="grower.html">ثبت داده</a></li>
      <li><a href="dashboard.html">داشبورد</a></li>
      <li><a href="#" onclick="logout()">خروج</a></li>
    </ul>
  </div>
</nav>

<section class="container section scrollspy">
  <h4>تحلیل داده‌های گلخانه</h4>
  <div class="row">
    <div class="input-field col s12 m6">
      <select id="crop-filter">
        <option value="همه">همه</option>
        <option value="گوجه‌فرنگی">گوجه‌فرنگی</option>
        <option value="خیار">خیار</option>
        <option value="فلفل">فلفل</option>
        <option value="کاهو">کاهو</option>
      </select>
      <label>فیلتر بر اساس محصول</label>
    </div>
  </div>

  <table class="highlight">
    <thead>
    <tr>
      <th>pH خاک</th>
      <th>دما (°C)</th>
      <th>رطوبت (%)</th>
      <th>آبیاری</th>
      <th>محصول</th>
      <th>امتیاز شدت</th>
      <th>وضعیت</th>
      <th>توصیه‌ها</th>
    </tr>
    </thead>
    <tbody id="expert-table"></tbody>
  </table>

  <h5>ثبت توصیه دستی</h5>
  <form id="recommendation-form">
    <div class="input-field">
      <textarea id="recommendation-text" class="materialize-textarea" required></textarea>
      <label for="recommendation-text">توصیه</label>
    </div>
    <button type="submit" class="btn green"><i class="fas fa-save left"></i>ثبت توصیه</button>
  </form>

  <h5>توصیه‌های دستی</h5>
  <ul id="manual-recommendations" class="collection"></ul>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> 
<script src="app.js"></script>
</body>
</html><!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>پنل مدیر</title>
  <link rel="stylesheet" href="styles.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css"  rel="stylesheet">
</head>
<body>
<nav>
  <div class="nav-wrapper red darken-2">
    <a href="#" class="brand-logo right">مدیریت</a>
    <ul class="left">
      <li><a href="grower.html">ثبت داده</a></li>
      <li><a href="dashboard.html">داشبورد</a></li>
      <li><a href="#" onclick="logout()">خروج</a></li>
    </ul>
  </div>
</nav>

<section class="container section scrollspy">
  <h4>مدیریت کاربران</h4>
  <ul id="user-list" class="collection"></ul>
  <button onclick="exportAllData()" class="btn blue"><i class="fas fa-download left"></i>دانلود CSV</button>
</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script> 
<script src="app.js"></script>
</body>
</html>/* General Styles */
body {
  font-family: 'Vazir', sans-serif;
  background-color: #f5f5f5;
  color: #333;
  direction: rtl;
  text-align: right;
  margin: 0;
  padding: 0;
  transition: background-color 0.3s, color 0.3s;
}

body.dark-mode {
  background-color: #263238;
  color: #e0e0e0;
}

h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 1rem;
}

a {
  color: inherit;
  text-decoration: none;
}

/* Navbar */
.navbar-fixed nav,
nav {
  background-color: #4caf50 !important;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.nav-wrapper a {
  color: #ffffff !important;
}

.brand-logo {
  font-weight: bold;
}

/* Cards */
.card {
  border-radius: 12px;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  transition: transform 0.3s, box-shadow 0.3s;
  background-color: #ffffff;
  margin: 1rem 0;
}

.card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

.card-content {
  padding: 1rem;
}

.card-title {
  font-size: 1.5rem;
  margin-bottom: 1rem;
}

body.dark-mode .card {
  background-color: #37474f;
  color: #e0e0e0;
}

/* Buttons */
.btn {
  background-color: #f28c38 !important;
  border-radius: 10px;
  transition: background-color 0.3s, transform 0.3s;
}

.btn:hover {
  background-color: #e67e22 !important;
  transform: scale(1.02);
}

.btn.red {
  background-color: #d32f2f !important;
}

.btn.green {
  background-color: #4caf50 !important;
}

.btn.blue {
  background-color: #0288d1 !important;
}

.btn.grey {
  background-color: #9e9e9e !important;
}

/* Forms */
.input-field input[type="text"],
.input-field input[type="number"],
.input-field select {
  border: 1px solid #ccc;
  border-radius: 8px;
  padding: 0.5rem 1rem;
  font-size: 1rem;
}

.input-field label {
  right: 1rem;
  left: auto;
}

.materialize-textarea {
  min-height: 80px;
}

/* Tables */
table.highlight > tbody > tr:hover {
  background-color: #e8f5e9;
}

table th {
  background-color: #f1f1f1;
}

body.dark-mode table th {
  background-color: #455a64;
  color: #fff;
}

/* Alerts & Notifications */
.success-message {
  position: fixed;
  top: 20px;
  right: 20px;
  background-color: #4caf50;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.5s;
  z-index: 1000;
  animation: slideIn 0.3s ease forwards;
}

.success-message.show {
  opacity: 1;
}

.alert {
  position: fixed;
  top: 80px;
  right: 20px;
  background-color: #d32f2f;
  color: #ffffff;
  padding: 15px 20px;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.5s;
  z-index: 1000;
  animation: slideIn 0.3s ease forwards;
}

.alert.show {
  opacity: 1;
}

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

/* Spinner */
.spinner {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 2000;
}

.hidden {
  display: none !important;
}

/* Collapsible */
.collapsible-header {
  cursor: pointer;
  padding: 10px;
  background-color: #f28c38;
  color: #ffffff;
  border-radius: 8px;
  margin-bottom: 10px;
}

.collapsible-body {
  display: none;
}

.collapsible.active .collapsible-body {
  display: block;
}

/* Login Page */
.login-page {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  background-color: #f5f5f5;
}

.login-box {
  background: white;
  padding: 2rem;
  border-radius: 12px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  width: 100%;
  max-width: 400px;
}

.login-box h3 {
  margin-bottom: 1.5rem;
}

.login-box input {
  width: 100%;
  margin-bottom: 1rem;
  padding: 0.7rem;
  border: 1px solid #ccc;
  border-radius: 8px;
}

.login-box button {
  width: 100%;
  padding: 0.7rem;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  font-size: 1rem;
}

#error-message {
  color: red;
  margin-top: 1rem;
}

/* Dashboard Sections */
.section {
  margin-top: 2rem;
}

.summary-card {
  margin-top: 1.5rem;
}

/* Charts */
canvas {
  margin: 1rem 0;
}

/* Collections (Recommendations) */
.collection {
  margin: 1rem 0;
  border: none;
}

.collection-item {
  background-color: #fafafa;
  border-radius: 8px;
  margin-bottom: 10px;
  padding: 1rem;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
}

.collection-item:hover {
  background-color: #f1f1f1;
}

.collection-item small {
  color: #888;
}

.recommendation {
  color: #0288d1;
  font-style: italic;
  margin-top: 10px;
  display: block;
}

.status-green {
  color: #4caf50;
  font-weight: bold;
}

.status-red {
  color: #d32f2f;
  font-weight: bold;
}

/* Dark Mode Toggle */
#dark-mode-toggle i {
  transition: color 0.3s;
}

body.dark-mode #dark-mode-toggle i {
  color: #fff;
}

/* Responsive Adjustments */
@media (max-width: 600px) {
  .container {
    padding: 0 10px;
  }

  .card {
    margin: 10px;
  }

  .btn {
    width: 100%;
    margin-bottom: 10px;
  }

  .collapsible-header {
    display: block;
  }
}// Utility functions
const showSpinner = () => document.getElementById('loading-spinner').classList.remove('hidden');
const hideSpinner = () => document.getElementById('loading-spinner').classList.add('hidden');
const showAlert = (message) => {
  const alert = document.getElementById('critical-alert');
  alert.textContent = message;
  alert.classList.add('show');
  setTimeout(() => alert.classList.remove('show'), 5000);
};

// Users
const defaultUsers = {
  "farmer": { password: "1234", role: "grower" },
  "expert": { password: "1234", role: "expert" },
  "admin":  { password: "1234", role: "admin" }
};

if (!localStorage.getItem('users')) {
  localStorage.setItem('users', JSON.stringify(defaultUsers));
}

function getUser(username) {
  return JSON.parse(localStorage.getItem('users') || '{}')[username];
}

function saveUser(user) {
  const users = JSON.parse(localStorage.getItem('users') || '{}');
  users[user.username] = user;
  localStorage.setItem('users', JSON.stringify(users));
}

function login() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;

  if (!username || !password) {
    alert("لطفاً تمام فیلدها را پر کنید.");
    return;
  }

  const users = JSON.parse(localStorage.getItem('users'));
  const user = users[username];

  if (!user || user.password !== password) {
    document.getElementById('error-message').textContent = "نام کاربری یا رمز اشتباه است.";
    return;
  }

  localStorage.setItem('loggedInUser', username);
  window.location.href = `${user.role}.html`;
}

function register() {
  const username = document.getElementById('username').value.trim();
  const password = document.getElementById('password').value;
  const role = document.getElementById('role').value;

  if (!username || !password) {
    alert("لطفاً تمام فیلدها را پر کنید.");
    return;
  }

  let users = JSON.parse(localStorage.getItem('users')) || {};
  if (users[username]) {
    document.getElementById('error-message').textContent = "این نام کاربری وجود دارد.";
    return;
  }

  users[username] = { password, role };
  localStorage.setItem('users', JSON.stringify(users));
  alert("ثبت‌نام با موفقیت انجام شد.");
  window.location.href = 'login.html';
}

function logout() {
  localStorage.removeItem('loggedInUser');
  window.location.href = 'login.html';
}

window.onload = function () {
  const allowedPages = {
    grower: ['grower.html', 'dashboard.html'],
    expert: ['expert.html', 'dashboard.html'],
    admin: ['admin.html', 'dashboard.html']
  };

  const currentPage = window.location.pathname.split('/').pop();
  const currentUser = localStorage.getItem('loggedInUser');

  if (!currentUser && !['login.html', 'register.html'].includes(currentPage)) {
    window.location.href = 'login.html';
  } else if (currentPage.includes('.html') && currentPage !== 'login.html' && currentPage !== 'register.html') {
    const role = JSON.parse(localStorage.getItem('users'))[currentUser]?.role;
    const allowed = allowedPages[role] || [];
    if (!allowed.includes(currentPage)) {
      alert('دسترسی غیرمجاز');
      window.history.back();
    }
  }

  loadData();
};